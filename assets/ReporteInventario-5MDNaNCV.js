import{r as d,j as e}from"./index-DnIkRolS.js";import{G as o}from"./Grid-IelTXcD1.js";import{T as a}from"./Typography-CfsH5zdM.js";import{P as S,a as x}from"./Button-BpD1F6SI.js";import{A as $}from"./Alert-CTdHQ_EP.js";import{f as h}from"./TextField-CfisxxK2.js";import{M as w}from"./MenuItem-Dl1BH1Ob.js";import"./useForkRef-_vsIMq9w.js";import"./useSlot-CCO6SuW7.js";import"./IconButton-7CARgz9E.js";import"./Portal-7hzC-RGP.js";import"./listItemTextClasses-B0jihKPi.js";import"./dividerClasses-CbI3AfZu.js";const s=i=>typeof i=="string"?i:"",U=()=>{const[i,g]=d.useState([]),[j,E]=d.useState([]),[p,C]=d.useState(!1),[P,u]=d.useState(""),[r,c]=d.useState({codigoInventario:"",nombreProducto:"",entradas:"",salidas:"",existencias:"",fecha:""});d.useEffect(()=>{g(JSON.parse(localStorage.getItem("reporteInventario")||"[]")),E(JSON.parse(localStorage.getItem("inventarios")||"[]"))},[]),d.useEffect(()=>{if(r.codigoInventario){const t=j.find(n=>n.codigoInventario===r.codigoInventario);t&&c(n=>({...n,nombreProducto:t.nombreProducto}))}},[r.codigoInventario,j]);const v=t=>{c({...r,[t.target.name]:t.target.value})},N=()=>{const t=parseFloat(r.entradas),n=parseFloat(r.salidas);if(!isNaN(t)&&!isNaN(n)){const l=(t-n).toString();c({...r,existencias:l})}else c({...r,existencias:""})},W=()=>{u("");const{codigoInventario:t,nombreProducto:n,entradas:l,salidas:b,existencias:A,fecha:I}=r;if(!t||!n||!l||!b||!A||!I){u("Completa todos los campos.");return}if(p){const m=i.map(y=>y.codigoInventario===t&&y.fecha===I?{...r}:y);g(m),localStorage.setItem("reporteInventario",JSON.stringify(m)),f();return}if(i.some(m=>m.codigoInventario===t&&m.fecha===I)){u("Ya existe un reporte para este inventario y fecha.");return}const O={...r},R=[...i,O];g(R),localStorage.setItem("reporteInventario",JSON.stringify(R)),f()},k=t=>{c({...t}),C(!0),u("")},F=(t,n)=>{const l=i.filter(b=>!(b.codigoInventario===t&&b.fecha===n));g(l),localStorage.setItem("reporteInventario",JSON.stringify(l)),f()},f=()=>{c({codigoInventario:"",nombreProducto:"",entradas:"",salidas:"",existencias:"",fecha:""}),C(!1),u("")};return e.jsxs(o,{container:!0,spacing:3,sx:{padding:3},children:[e.jsx(o,{item:!0,xs:12,children:e.jsx(a,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",fontWeight:"bold"},children:"Reporte de Inventario"})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(S,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(a,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:p?"Modificar Reporte":"Registrar Reporte"}),P&&e.jsx($,{severity:"error",sx:{mb:2},children:P}),e.jsx("form",{onSubmit:t=>{t.preventDefault(),W()},children:e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(h,{select:!0,label:"Código Inventario",name:"codigoInventario",variant:"outlined",fullWidth:!0,value:r.codigoInventario,onChange:v,children:j.map(t=>e.jsx(w,{value:t.codigoInventario,children:t.codigoInventario},t.codigoInventario))})}),r.nombreProducto&&e.jsx(o,{item:!0,xs:12,md:4,children:e.jsxs(a,{variant:"body1",sx:{mt:2},children:[e.jsx("b",{children:"Nombre Producto:"})," ",r.nombreProducto]})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(h,{label:"Entradas",name:"entradas",type:"number",variant:"outlined",fullWidth:!0,value:r.entradas,onChange:v,inputProps:{min:0}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(h,{label:"Salidas",name:"salidas",type:"number",variant:"outlined",fullWidth:!0,value:r.salidas,onChange:v,inputProps:{min:0}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(h,{label:"Existencias",name:"existencias",variant:"outlined",fullWidth:!0,value:r.existencias,InputProps:{readOnly:!0}})}),e.jsx(o,{item:!0,xs:12,md:4,children:e.jsx(h,{label:"Fecha",name:"fecha",type:"date",variant:"outlined",fullWidth:!0,value:r.fecha,onChange:v,InputLabelProps:{shrink:!0}})}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(x,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"},borderRadius:2,padding:"12px"},children:p?"Modificar Reporte":"Registrar Reporte"}),e.jsx(x,{variant:"outlined",color:"secondary",onClick:N,fullWidth:!0,sx:{mt:1},children:"Generar Existencias"}),p&&e.jsx(x,{variant:"outlined",color:"secondary",onClick:f,fullWidth:!0,sx:{mt:1},children:"Cancelar"})]})]})})]})}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(S,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(a,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold",mb:4},children:"Reportes de Inventario Registrados"}),e.jsx(o,{container:!0,spacing:2,children:i.length===0?e.jsx(a,{variant:"body1",sx:{width:"100%",mb:6},children:"No hay reportes de inventario registrados."}):i.map((t,n)=>e.jsx(o,{item:!0,xs:12,children:e.jsxs(S,{sx:{padding:2,marginBottom:2,borderRadius:2,boxShadow:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(a,{variant:"body1",children:`Código Inventario: ${s(t.codigoInventario)}`}),e.jsx(a,{variant:"body1",children:`Nombre Producto: ${s(t.nombreProducto)}`}),e.jsx(a,{variant:"body1",children:`Entradas: ${s(t.entradas)}`}),e.jsx(a,{variant:"body1",children:`Salidas: ${s(t.salidas)}`}),e.jsx(a,{variant:"body1",children:`Existencias: ${s(t.existencias)}`}),e.jsx(a,{variant:"body1",children:`Fecha: ${s(t.fecha)}`})]}),e.jsxs("div",{children:[e.jsx(x,{color:"primary",onClick:()=>k(t),sx:{marginRight:1},children:"Modificar"}),e.jsx(x,{color:"error",onClick:()=>F(s(t.codigoInventario),s(t.fecha)),children:"Eliminar"})]})]})},n))})]})})]})};export{U as default};
