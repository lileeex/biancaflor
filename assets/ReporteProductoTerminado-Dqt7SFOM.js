import{r as s,j as e}from"./index-DnIkRolS.js";import{G as t}from"./Grid-IelTXcD1.js";import{T as r}from"./Typography-CfsH5zdM.js";import{P as E,a as y}from"./Button-BpD1F6SI.js";import{A as U}from"./Alert-CTdHQ_EP.js";import{f as l}from"./TextField-CfisxxK2.js";import{M as V}from"./MenuItem-Dl1BH1Ob.js";import"./useForkRef-_vsIMq9w.js";import"./useSlot-CCO6SuW7.js";import"./IconButton-7CARgz9E.js";import"./Portal-7hzC-RGP.js";import"./listItemTextClasses-B0jihKPi.js";import"./dividerClasses-CbI3AfZu.js";const p=c=>typeof c=="string"?c:"",le=()=>{var R,k;const[c,A]=s.useState(""),[P,$]=s.useState(""),[h,b]=s.useState([]),[F,w]=s.useState([]),[T,B]=s.useState([]),[z,M]=s.useState([]),[m,N]=s.useState(!1),[W,g]=s.useState(""),[a,C]=s.useState({codigo:"",fechaFinalizado:"",codigoLote:"",saborGelato:"",heladero:"",litrosPorEnvase:"",cantidad:""});s.useEffect(()=>{b(JSON.parse(localStorage.getItem("productosTerminados")||"[]")),w(JSON.parse(localStorage.getItem("lotes")||"[]")),B(JSON.parse(localStorage.getItem("sabores")||"[]")),M(JSON.parse(localStorage.getItem("heladeros")||"[]"))},[]);const G=h.filter(o=>!c||!P?!0:o.fechaFinalizado>=c&&o.fechaFinalizado<=P),x=o=>{C({...a,[o.target.name]:o.target.value})},H=()=>{g("");const{codigo:o,fechaFinalizado:u,codigoLote:i,saborGelato:L,heladero:I,litrosPorEnvase:j,cantidad:v}=a;if(!o||!u||!i||!L||!I||!j||!v){g("Completa todos los campos.");return}if(m){const S=h.map(O=>O.codigo===o?{...a}:O);b(S),localStorage.setItem("productosTerminados",JSON.stringify(S)),f();return}if(h.some(S=>S.codigo===o)){g("No se pueden registrar dos productos terminados con el mismo c贸digo.");return}const d={...a},J=[...h,d];b(J),localStorage.setItem("productosTerminados",JSON.stringify(J)),f()},D=o=>{C({...o}),N(!0),g("")},q=o=>{const u=h.filter(i=>i.codigo!==o);b(u),localStorage.setItem("productosTerminados",JSON.stringify(u)),f()},f=()=>{C({codigo:"",fechaFinalizado:"",codigoLote:"",saborGelato:"",heladero:"",litrosPorEnvase:"",cantidad:""}),N(!1),g("")},n=F.find(o=>o.codigoLote===a.codigoLote)||null,K=n?((R=z.find(o=>o.codigo===n.heladero))==null?void 0:R.nombre)||n.heladero:"",Q=n?((k=T.find(o=>o.codigoSabor===n.saborGelato))==null?void 0:k.nombreSabor)||n.saborGelato:"";return e.jsxs(t,{container:!0,spacing:3,sx:{padding:3},children:[e.jsx(t,{item:!0,xs:12,children:e.jsx(r,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",fontWeight:"bold"},children:"Reporte de Producto Terminado"})}),e.jsx(t,{item:!0,xs:12,children:e.jsxs(E,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:m?"Modificar Producto Terminado":"Registrar Producto Terminado"}),W&&e.jsx(U,{severity:"error",sx:{mb:2},children:W}),e.jsx("form",{onSubmit:o=>{o.preventDefault(),H()},children:e.jsxs(t,{container:!0,spacing:2,children:[e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"C贸digo",name:"codigo",variant:"outlined",fullWidth:!0,value:a.codigo,onChange:x,disabled:m})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Fecha Finalizado",name:"fechaFinalizado",type:"date",variant:"outlined",fullWidth:!0,value:a.fechaFinalizado,onChange:x,InputLabelProps:{shrink:!0}})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{select:!0,label:"C贸digo de Lote",name:"codigoLote",variant:"outlined",fullWidth:!0,value:a.codigoLote,onChange:x,children:F.map(o=>e.jsx(V,{value:o.codigoLote,children:o.codigoLote},o.codigoLote))})}),n&&e.jsxs(e.Fragment,{children:[e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(r,{variant:"body1",children:[e.jsx("b",{children:"Heladero:"})," ",K]})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsxs(r,{variant:"body1",children:[e.jsx("b",{children:"Sabor Gelato:"})," ",Q]})})]}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Litros por Envase",name:"litrosPorEnvase",variant:"outlined",type:"number",fullWidth:!0,value:a.litrosPorEnvase,onChange:x,inputProps:{min:0}})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Cantidad",name:"cantidad",variant:"outlined",type:"number",fullWidth:!0,value:a.cantidad,onChange:x,inputProps:{min:0}})}),e.jsxs(t,{item:!0,xs:12,children:[e.jsx(y,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"},borderRadius:2,padding:"12px"},children:m?"Modificar Producto Terminado":"Registrar Producto Terminado"}),m&&e.jsx(y,{variant:"outlined",color:"secondary",onClick:f,fullWidth:!0,sx:{mt:1},children:"Cancelar"})]})]})})]})}),e.jsx(t,{item:!0,xs:12,children:e.jsxs(E,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(r,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold",mb:4},children:"Reporte de Productos Terminados"}),e.jsxs(t,{container:!0,spacing:2,sx:{mb:2},children:[e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Fecha Inicio",type:"date",variant:"outlined",fullWidth:!0,value:c,onChange:o=>A(o.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(t,{item:!0,xs:12,md:4,children:e.jsx(l,{label:"Fecha Fin",type:"date",variant:"outlined",fullWidth:!0,value:P,onChange:o=>$(o.target.value),InputLabelProps:{shrink:!0}})})]}),e.jsx(t,{container:!0,spacing:2,children:G.length===0?e.jsx(r,{variant:"body1",sx:{width:"100%",mb:6},children:"No hay productos terminados registrados en el rango seleccionado."}):G.map((o,u)=>{var j,v;const i=F.find(d=>d.codigoLote===o.codigoLote),L=i?((j=z.find(d=>d.codigo===i.heladero))==null?void 0:j.nombre)||i.heladero:"",I=i?((v=T.find(d=>d.codigoSabor===i.saborGelato))==null?void 0:v.nombreSabor)||i.saborGelato:"";return e.jsx(t,{item:!0,xs:12,children:e.jsxs(E,{sx:{padding:2,marginBottom:2,borderRadius:2,boxShadow:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(r,{variant:"body1",children:`Fecha Finalizado: ${p(o.fechaFinalizado)}`}),e.jsx(r,{variant:"body1",children:`C贸digo de Lote: ${p(o.codigoLote)}`}),e.jsx(r,{variant:"body1",children:`Sabor Gelato: ${I}`}),e.jsx(r,{variant:"body1",children:`Heladero: ${L}`}),e.jsx(r,{variant:"body1",children:`Litros por Envase: ${p(o.litrosPorEnvase)}`}),e.jsx(r,{variant:"body1",children:`Cantidad: ${p(o.cantidad)}`})]}),e.jsxs("div",{children:[e.jsx(y,{color:"primary",onClick:()=>D(o),sx:{marginRight:1},children:"Modificar"}),e.jsx(y,{color:"error",onClick:()=>q(p(o.codigo)),children:"Eliminar"})]})]})},u)})})]})})]})};export{le as default};
