import{r,j as e}from"./index-DnIkRolS.js";import{G as a}from"./Grid-IelTXcD1.js";import{T as s}from"./Typography-CfsH5zdM.js";import{P as O,a as G}from"./Button-BpD1F6SI.js";import{A as oe}from"./Alert-CTdHQ_EP.js";import{f as m}from"./TextField-CfisxxK2.js";import{M as H}from"./MenuItem-Dl1BH1Ob.js";import"./useForkRef-_vsIMq9w.js";import"./useSlot-CCO6SuW7.js";import"./IconButton-7CARgz9E.js";import"./Portal-7hzC-RGP.js";import"./listItemTextClasses-B0jihKPi.js";import"./dividerClasses-CbI3AfZu.js";const t=i=>typeof i=="string"?i:"",he=()=>{var B,w;const[i,$]=r.useState(""),[b,E]=r.useState(""),[c,f]=r.useState(""),[C,j]=r.useState(""),[L,x]=r.useState(""),[N,p]=r.useState(""),[u,P]=r.useState([]),[J,T]=r.useState([]),[S,D]=r.useState([]),[A,q]=r.useState([]),[F,K]=r.useState([]),[I,R]=r.useState(!1),[k,l]=r.useState(""),g=J.find(o=>o.codigoLote===b)||null,y=S.find(o=>o.codigoEnvase===c)||null;r.useEffect(()=>{P(JSON.parse(localStorage.getItem("envasados")||"[]")),T(JSON.parse(localStorage.getItem("lotes")||"[]")),D(JSON.parse(localStorage.getItem("envases")||"[]")),q(JSON.parse(localStorage.getItem("sabores")||"[]")),K(JSON.parse(localStorage.getItem("heladeros")||"[]"))},[]),r.useEffect(()=>{const o=u.find(d=>d.codigoEnvasado===i);o?(E(t(o.codigoLote)),f(t(o.codigoEnvase)),j(t(o.fecha)),x(t(o.litrosPorEnvase)),p(t(o.cantidad)),R(!0),l("")):i&&(E(""),f(""),j(""),x(""),p(""),R(!1),l(""))},[i,u]),r.useEffect(()=>{if(c){const o=S.find(d=>d.codigoEnvase===c);o&&x(t(o.litrosPorEnvase))}},[c,S]);const Q=()=>{if(l(""),!i||!b||!c||!C||!L||!N){l("Completa todos los campos.");return}if(!g){l("El lote no existe. Regístrelo primero.");return}if(!y){l("El envase no existe. Regístrelo primero.");return}if(I){const n=u.map(h=>h.codigoEnvasado===i?{codigoEnvasado:i,codigoLote:b,codigoEnvase:c,fecha:C,litrosPorEnvase:L,cantidad:N}:h);P(n),localStorage.setItem("envasados",JSON.stringify(n)),W();return}if(u.some(n=>n.codigoEnvasado===i)){l("No se pueden registrar dos envasados con el mismo código.");return}const o={codigoEnvasado:i,codigoLote:b,codigoEnvase:c,fecha:C,litrosPorEnvase:L,cantidad:N},d=[...u,o];P(d),localStorage.setItem("envasados",JSON.stringify(d)),W()},U=o=>{$(t(o.codigoEnvasado)),E(t(o.codigoLote)),f(t(o.codigoEnvase)),j(t(o.fecha)),x(t(o.litrosPorEnvase)),p(t(o.cantidad)),R(!0),l("")},V=o=>{const d=u.filter(n=>n.codigoEnvasado!==o);P(d),localStorage.setItem("envasados",JSON.stringify(d)),W()},W=()=>{$(""),E(""),f(""),j(""),x(""),p(""),R(!1),l("")},X=g?((B=F.find(o=>o.codigo===g.heladero))==null?void 0:B.nombre)||g.heladero:"",Y=g?((w=A.find(o=>o.codigoSabor===g.saborGelato))==null?void 0:w.nombreSabor)||g.saborGelato:"",Z=y?y.nombreEnvase:"";return e.jsxs(a,{container:!0,spacing:3,sx:{padding:3},children:[e.jsxs(a,{item:!0,xs:12,children:[e.jsx(s,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",fontWeight:"bold"},children:"Gestionar Envasado"}),e.jsx(s,{variant:"subtitle1",gutterBottom:!0,sx:{textAlign:"center",color:"#555"},children:"Envasado de Gelato"})]}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(O,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:I?"Modificar Envasado":"Registrar Envasado"}),k&&e.jsx(oe,{severity:"error",sx:{mb:2},children:k}),e.jsx("form",{onSubmit:o=>{o.preventDefault(),Q()},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(m,{label:"Código del Envasado",variant:"outlined",fullWidth:!0,value:i,onChange:o=>$(o.target.value),inputProps:{maxLength:10}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(m,{select:!0,label:"Código de Lote",variant:"outlined",fullWidth:!0,value:b,onChange:o=>E(o.target.value),children:J.map(o=>e.jsx(H,{value:o.codigoLote,children:o.codigoLote},o.codigoLote))})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(m,{select:!0,label:"Código de Envase",variant:"outlined",fullWidth:!0,value:c,onChange:o=>f(o.target.value),children:S.map(o=>e.jsx(H,{value:o.codigoEnvase,children:o.codigoEnvase},o.codigoEnvase))})}),g&&e.jsxs(e.Fragment,{children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(s,{variant:"body1",children:[e.jsx("b",{children:"Heladero:"})," ",X]})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(s,{variant:"body1",children:[e.jsx("b",{children:"Sabor Gelato:"})," ",Y]})})]}),y&&e.jsxs(e.Fragment,{children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(s,{variant:"body1",children:[e.jsx("b",{children:"Nombre Envase:"})," ",Z]})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsxs(s,{variant:"body1",children:[e.jsx("b",{children:"Litros por Envase:"})," ",y.litrosPorEnvase]})})]}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(m,{label:"Fecha de Envasado",variant:"outlined",type:"date",fullWidth:!0,value:C,onChange:o=>j(o.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(m,{label:"Litros por Envase",variant:"outlined",type:"number",fullWidth:!0,value:L,onChange:o=>x(o.target.value),inputProps:{min:0}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(m,{label:"Cantidad",variant:"outlined",type:"number",fullWidth:!0,value:N,onChange:o=>p(o.target.value),inputProps:{min:0}})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(G,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"},borderRadius:2,padding:"12px"},children:I?"Modificar Envasado":"Registrar Envasado"}),I&&e.jsx(G,{variant:"outlined",color:"secondary",onClick:W,fullWidth:!0,sx:{mt:1},children:"Cancelar"})]})]})})]})}),e.jsx(a,{item:!0,xs:12,children:e.jsxs(O,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:"Envasados Registrados"}),e.jsx(a,{container:!0,spacing:2,children:u.length===0?e.jsx(s,{variant:"body1",sx:{width:"100%"},children:"No hay envasados registrados."}):u.map((o,d)=>{var M,z;const n=J.find(v=>v.codigoLote===o.codigoLote),h=S.find(v=>v.codigoEnvase===o.codigoEnvase),_=n?((M=F.find(v=>v.codigo===n.heladero))==null?void 0:M.nombre)||n.heladero:"",ee=n?((z=A.find(v=>v.codigoSabor===n.saborGelato))==null?void 0:z.nombreSabor)||n.saborGelato:"";return e.jsx(a,{item:!0,xs:12,children:e.jsxs(O,{sx:{padding:2,marginBottom:2,borderRadius:2,boxShadow:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(s,{variant:"body1",children:`Código Envasado: ${t(o.codigoEnvasado)}`}),e.jsx(s,{variant:"body1",children:`Código Lote: ${t(o.codigoLote)}`}),e.jsx(s,{variant:"body1",children:`Sabor Gelato: ${ee}`}),e.jsx(s,{variant:"body1",children:`Heladero: ${_}`}),e.jsx(s,{variant:"body1",children:`Código Envase: ${t(o.codigoEnvase)}`}),e.jsx(s,{variant:"body1",children:`Nombre Envase: ${(h==null?void 0:h.nombreEnvase)||""}`}),e.jsx(s,{variant:"body1",children:`Litros por Envase: ${t(o.litrosPorEnvase)}`}),e.jsx(s,{variant:"body1",children:`Cantidad: ${t(o.cantidad)}`}),e.jsx(s,{variant:"body1",children:`Fecha: ${t(o.fecha)}`})]}),e.jsxs("div",{children:[e.jsx(G,{color:"primary",onClick:()=>U(o),sx:{marginRight:1},children:"Modificar"}),e.jsx(G,{color:"error",onClick:()=>V(t(o.codigoEnvasado)),children:"Eliminar"})]})]})},d)})})]})})]})};export{he as default};
