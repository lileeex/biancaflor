import{r,j as e}from"./index-DnIkRolS.js";import{G as s}from"./Grid-IelTXcD1.js";import{T as i}from"./Typography-CfsH5zdM.js";import{P as A,a as J}from"./Button-BpD1F6SI.js";import{A as oo}from"./Alert-CTdHQ_EP.js";import{f as y}from"./TextField-CfisxxK2.js";import{M as D}from"./MenuItem-Dl1BH1Ob.js";import"./useForkRef-_vsIMq9w.js";import"./useSlot-CCO6SuW7.js";import"./IconButton-7CARgz9E.js";import"./Portal-7hzC-RGP.js";import"./listItemTextClasses-B0jihKPi.js";import"./dividerClasses-CbI3AfZu.js";const t=n=>typeof n=="string"?n:"",mo=()=>{var M,z;const[n,O]=r.useState(""),[m,f]=r.useState(""),[l,p]=r.useState(""),[$,v]=r.useState(""),[I,j]=r.useState(""),[C,S]=r.useState(""),[g,L]=r.useState([]),[N,q]=r.useState([]),[k,K]=r.useState([]),[B,Q]=r.useState([]),[b,U]=r.useState([]),[E,R]=r.useState(!1),[F,u]=r.useState("");r.useEffect(()=>{L(JSON.parse(localStorage.getItem("productosProceso")||"[]")),q(JSON.parse(localStorage.getItem("lotes")||"[]")),K(JSON.parse(localStorage.getItem("sabores")||"[]")),Q(JSON.parse(localStorage.getItem("heladeros")||"[]")),U(JSON.parse(localStorage.getItem("inventarios")||"[]"))},[]),r.useEffect(()=>{const o=g.find(a=>a.codigoProductoProceso===n);o?(f(t(o.codigoLote)),p(t(o.codigoInventario)),v(t(o.nombreProductoProceso)),j(t(o.cantidad)),S(t(o.fecha)),R(!0),u("")):n&&(f(""),p(""),v(""),j(""),S(""),R(!1),u(""))},[n,g]),r.useEffect(()=>{if(l){const o=b.find(a=>a.codigoInventario===l);o&&v(t(o.nombreProducto))}},[l,b]);const V=()=>{if(u(""),!n||!m||!l||!$||!I||!C){u("Completa todos los campos.");return}const o=N.find(d=>d.codigoLote===m),a=b.find(d=>d.codigoInventario===l);if(!o){u("El lote no existe. Regístrelo primero.");return}if(!a){u("El inventario no existe. Regístrelo primero.");return}if(E){const d=g.map(P=>P.codigoProductoProceso===n?{codigoProductoProceso:n,codigoLote:m,codigoInventario:l,nombreProductoProceso:$,cantidad:I,fecha:C}:P);L(d),localStorage.setItem("productosProceso",JSON.stringify(d)),G();return}if(g.some(d=>d.codigoProductoProceso===n)){u("No se pueden registrar dos productos en proceso con el mismo código.");return}const c={codigoProductoProceso:n,codigoLote:m,codigoInventario:l,nombreProductoProceso:$,cantidad:I,fecha:C},W=[...g,c];L(W),localStorage.setItem("productosProceso",JSON.stringify(W)),G()},X=o=>{O(t(o.codigoProductoProceso)),f(t(o.codigoLote)),p(t(o.codigoInventario)),v(t(o.nombreProductoProceso)),j(t(o.cantidad)),S(t(o.fecha)),R(!0),u("")},Y=o=>{const a=g.filter(c=>c.codigoProductoProceso!==o);L(a),localStorage.setItem("productosProceso",JSON.stringify(a)),G()},G=()=>{O(""),f(""),p(""),v(""),j(""),S(""),R(!1),u("")},x=N.find(o=>o.codigoLote===m)||null,Z=x?((M=B.find(o=>o.codigo===x.heladero))==null?void 0:M.nombre)||x.heladero:"",_=x?((z=k.find(o=>o.codigoSabor===x.saborGelato))==null?void 0:z.nombreSabor)||x.saborGelato:"",w=b.find(o=>o.codigoInventario===l)||null;return e.jsxs(s,{container:!0,spacing:3,sx:{padding:3},children:[e.jsxs(s,{item:!0,xs:12,children:[e.jsx(i,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",fontWeight:"bold"},children:"Gestionar Producto en Proceso"}),e.jsx(i,{variant:"subtitle1",gutterBottom:!0,sx:{textAlign:"center",color:"#555"},children:"Producto en Proceso de Gelato"})]}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(A,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:E?"Modificar Producto en Proceso":"Registrar Producto en Proceso"}),F&&e.jsx(oo,{severity:"error",sx:{mb:2},children:F}),e.jsx("form",{onSubmit:o=>{o.preventDefault(),V()},children:e.jsxs(s,{container:!0,spacing:2,children:[e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(y,{label:"Código Producto Proceso",variant:"outlined",fullWidth:!0,value:n,onChange:o=>O(o.target.value),inputProps:{maxLength:10}})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(y,{select:!0,label:"Código de Lote",variant:"outlined",fullWidth:!0,value:m,onChange:o=>f(o.target.value),children:N.map(o=>e.jsx(D,{value:o.codigoLote,children:o.codigoLote},o.codigoLote))})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(y,{select:!0,label:"Código de Inventario",variant:"outlined",fullWidth:!0,value:l,onChange:o=>p(o.target.value),children:b.map(o=>e.jsx(D,{value:o.codigoInventario,children:o.codigoInventario},o.codigoInventario))})}),x&&e.jsxs(e.Fragment,{children:[e.jsx(s,{item:!0,xs:12,md:4,children:e.jsxs(i,{variant:"body1",children:[e.jsx("b",{children:"Heladero:"})," ",Z]})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsxs(i,{variant:"body1",children:[e.jsx("b",{children:"Sabor Gelato:"})," ",_]})})]}),w&&e.jsx(s,{item:!0,xs:12,md:4,children:e.jsxs(i,{variant:"body1",children:[e.jsx("b",{children:"Nombre Producto:"})," ",w.nombreProducto]})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(y,{label:"Cantidad",variant:"outlined",type:"number",fullWidth:!0,value:I,onChange:o=>j(o.target.value),inputProps:{min:0}})}),e.jsx(s,{item:!0,xs:12,md:4,children:e.jsx(y,{label:"Fecha",variant:"outlined",type:"date",fullWidth:!0,value:C,onChange:o=>S(o.target.value),InputLabelProps:{shrink:!0}})}),e.jsxs(s,{item:!0,xs:12,children:[e.jsx(J,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"},borderRadius:2,padding:"12px"},children:E?"Modificar Producto en Proceso":"Registrar Producto en Proceso"}),E&&e.jsx(J,{variant:"outlined",color:"secondary",onClick:G,fullWidth:!0,sx:{mt:1},children:"Cancelar"})]})]})})]})}),e.jsx(s,{item:!0,xs:12,children:e.jsxs(A,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(i,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold",mb:4},children:"Productos en Proceso Registrados"}),e.jsx(s,{container:!0,spacing:2,children:g.length===0?e.jsx(i,{variant:"body1",sx:{width:"100%",mb:6},children:"No hay productos en proceso registrados."}):g.map((o,a)=>{var H,T;const c=N.find(h=>h.codigoLote===o.codigoLote),W=c?((H=B.find(h=>h.codigo===c.heladero))==null?void 0:H.nombre)||c.heladero:"",d=c?((T=k.find(h=>h.codigoSabor===c.saborGelato))==null?void 0:T.nombreSabor)||c.saborGelato:"",P=b.find(h=>h.codigoInventario===o.codigoInventario);return e.jsx(s,{item:!0,xs:12,children:e.jsxs(A,{sx:{padding:2,marginBottom:2,borderRadius:2,boxShadow:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(i,{variant:"body1",children:`Código Producto Proceso: ${t(o.codigoProductoProceso)}`}),e.jsx(i,{variant:"body1",children:`Código Lote: ${t(o.codigoLote)}`}),e.jsx(i,{variant:"body1",children:`Sabor Gelato: ${d}`}),e.jsx(i,{variant:"body1",children:`Heladero: ${W}`}),e.jsx(i,{variant:"body1",children:`Código Inventario: ${t(o.codigoInventario)}`}),e.jsx(i,{variant:"body1",children:`Nombre Producto: ${(P==null?void 0:P.nombreProducto)||""}`}),e.jsx(i,{variant:"body1",children:`Cantidad: ${t(o.cantidad)}`}),e.jsx(i,{variant:"body1",children:`Fecha: ${t(o.fecha)}`})]}),e.jsxs("div",{children:[e.jsx(J,{color:"primary",onClick:()=>X(o),sx:{marginRight:1},children:"Modificar"}),e.jsx(J,{color:"error",onClick:()=>Y(t(o.codigoProductoProceso)),children:"Eliminar"})]})]})},a)})})]})})]})};export{mo as default};
