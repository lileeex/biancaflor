import{r as d,j as e}from"./index-DnIkRolS.js";import{G as r}from"./Grid-IelTXcD1.js";import{T as a}from"./Typography-CfsH5zdM.js";import{P as R,a as P}from"./Button-BpD1F6SI.js";import{A as V}from"./Alert-CTdHQ_EP.js";import{f as v}from"./TextField-CfisxxK2.js";import"./useForkRef-_vsIMq9w.js";import"./useSlot-CCO6SuW7.js";import"./IconButton-7CARgz9E.js";import"./Portal-7hzC-RGP.js";const de=()=>{var A,G;const[c,y]=d.useState(""),[x,C]=d.useState(""),[p,L]=d.useState(""),[u,b]=d.useState([]),[g,j]=d.useState([]),[N,w]=d.useState([]),[I,B]=d.useState([]),[W,D]=d.useState([]),[n,f]=d.useState(null),[h,$]=d.useState(!1),[k,l]=d.useState(""),E=[{codigo:"P1",nombre:"Leche"},{codigo:"P2",nombre:"Azúcar"},{codigo:"P3",nombre:"Cacao"}];d.useEffect(()=>{const o=JSON.parse(localStorage.getItem("pesados")||"[]");j(o);const s=JSON.parse(localStorage.getItem("lotes")||"[]");w(s);const t=JSON.parse(localStorage.getItem("heladeros")||"[]");B(t);const m=JSON.parse(localStorage.getItem("sabores")||"[]");D(m)},[]);const F=()=>{l("");const o=N.find(s=>s.codigoLote===x);if(!o){f(null),b([]),l("No existe el lote. Regístrelo primero.");return}f(o),b(E.map(s=>({...s,peso:""})))},z=()=>{if(l(""),!c||!x||!p||u.some(t=>!t.peso)){l("Completa todos los campos y los pesos.");return}if(h){const t=g.map(m=>m.codigoPesado===c?{codigoPesado:c,codigoLote:x,fecha:p,productos:u}:m);j(t),localStorage.setItem("pesados",JSON.stringify(t)),S();return}if(g.some(t=>t.codigoPesado===c)){l("No se pueden registrar dos pesados con el mismo código.");return}const o={codigoPesado:c,codigoLote:x,fecha:p,productos:u},s=[...g,o];j(s),localStorage.setItem("pesados",JSON.stringify(s)),S()},H=o=>{y(o.codigoPesado),C(o.codigoLote),L(o.fecha),b(o.productos),f(N.find(s=>s.codigoLote===o.codigoLote)||null),$(!0),l("")},M=o=>{const s=g.filter(t=>t.codigoPesado!==o);j(s),localStorage.setItem("pesados",JSON.stringify(s)),S()},S=()=>{y(""),C(""),L(""),b([]),f(null),$(!1),l("")},T=(o,s)=>{b(u.map(t=>t.codigo===o?{...t,peso:s}:t))},q=n?((A=I.find(o=>o.codigo===n.heladero))==null?void 0:A.nombre)||n.heladero:"",K=n?((G=W.find(o=>o.codigoSabor===n.saborGelato))==null?void 0:G.nombreSabor)||n.saborGelato:"";return e.jsxs(r,{container:!0,spacing:3,sx:{padding:3},children:[e.jsx(r,{item:!0,xs:12,children:e.jsx(a,{variant:"h4",gutterBottom:!0,sx:{textAlign:"center",fontWeight:"bold"},children:"Gestionar Pesado"})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(R,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(a,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:h?"Modificar Pesado":"Registrar Pesado"}),k&&e.jsx(V,{severity:"error",sx:{mb:2},children:k}),e.jsx("form",{onSubmit:o=>{o.preventDefault(),z()},children:e.jsxs(r,{container:!0,spacing:2,children:[e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"Código del Pesado",variant:"outlined",fullWidth:!0,value:c,onChange:o=>y(o.target.value),disabled:h})}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"Código del Lote",variant:"outlined",fullWidth:!0,value:x,onChange:o=>C(o.target.value),onBlur:F,disabled:h})}),n&&e.jsxs(e.Fragment,{children:[e.jsx(r,{item:!0,xs:12,md:4,children:e.jsxs(a,{variant:"body1",children:[e.jsx("b",{children:"Heladero:"})," ",q]})}),e.jsx(r,{item:!0,xs:12,md:4,children:e.jsxs(a,{variant:"body1",children:[e.jsx("b",{children:"Sabor:"})," ",K]})})]}),e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(v,{label:"Fecha de Pesado",variant:"outlined",type:"date",fullWidth:!0,value:p,onChange:o=>L(o.target.value),InputLabelProps:{shrink:!0}})}),u.length>0&&e.jsxs(r,{item:!0,xs:12,children:[e.jsx(a,{variant:"subtitle1",sx:{mt:2,mb:1},children:"Productos a pesar:"}),e.jsx(r,{container:!0,spacing:2,children:u.map((o,s)=>e.jsx(r,{item:!0,xs:12,md:6,children:e.jsx(v,{label:`Peso de ${o.nombre}`,variant:"outlined",type:"number",fullWidth:!0,value:o.peso,onChange:t=>T(o.codigo,t.target.value)})},o.codigo))})]}),e.jsxs(r,{item:!0,xs:12,children:[e.jsx(P,{variant:"contained",color:"primary",type:"submit",fullWidth:!0,sx:{backgroundColor:"#00796b","&:hover":{backgroundColor:"#004d40"},borderRadius:2,padding:"12px"},children:h?"Modificar Pesado":"Registrar Pesado"}),h&&e.jsx(P,{variant:"outlined",color:"secondary",onClick:S,fullWidth:!0,sx:{mt:1},children:"Cancelar"})]})]})})]})}),e.jsx(r,{item:!0,xs:12,children:e.jsxs(R,{sx:{padding:3,borderRadius:2,boxShadow:3},children:[e.jsx(a,{variant:"h6",gutterBottom:!0,sx:{color:"#00796b",fontWeight:"bold"},children:"Pesados Registrados"}),e.jsx(r,{container:!0,spacing:2,children:g.length===0?e.jsx(a,{variant:"body1",sx:{width:"100%"},children:"No hay pesados registrados."}):g.map((o,s)=>{var J,O;const t=N.find(i=>i.codigoLote===o.codigoLote),m=t?((J=I.find(i=>i.codigo===t.heladero))==null?void 0:J.nombre)||t.heladero:"",Q=t?((O=W.find(i=>i.codigoSabor===t.saborGelato))==null?void 0:O.nombreSabor)||t.saborGelato:"";return e.jsx(r,{item:!0,xs:12,children:e.jsxs(R,{sx:{padding:2,marginBottom:2,borderRadius:2,boxShadow:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx(a,{variant:"body1",children:`Código de Pesado: ${o.codigoPesado}`}),e.jsx(a,{variant:"body1",children:`Código de Lote: ${o.codigoLote}`}),e.jsx(a,{variant:"body1",children:`Heladero: ${m}`}),e.jsx(a,{variant:"body1",children:`Sabor: ${Q}`}),e.jsx(a,{variant:"body1",children:`Fecha: ${o.fecha}`}),o.productos.map((i,U)=>e.jsx(a,{variant:"body2",children:`${i.nombre}: ${i.peso} ${i.nombre.toLowerCase()==="leche"?"litros":"kg"}`},U))]}),e.jsxs("div",{children:[e.jsx(P,{color:"primary",onClick:()=>H(o),sx:{marginRight:1},children:"Modificar"}),e.jsx(P,{color:"error",onClick:()=>M(o.codigoPesado),children:"Eliminar"})]})]})},s)})})]})})]})};export{de as default};
